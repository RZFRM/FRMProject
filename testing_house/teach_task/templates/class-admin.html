<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Layui</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="../../static/res/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../static/res/trainTask/static/css/school-admin.css" media="all">
    <!-- 注意：如果你直接复制所有代码到本地，上述css路径需要改成你本地的 -->

    <style type="text/css">
        .layui-table-body {
            overflow-x: hidden !important;
        }

        .layui-card-body {
            margin: auto;
            background: rgba(255, 255, 255, 1);
        }

        .layui-table-fixed-l {
            opacity: 0;
        }

        .layui-card-body {
            width: 98%;
            margin: auto;
            background: rgba(255, 255, 255, 1);
        }
    </style>
</head>
<body style="width: 99%">
<div class="layui-col-train-teach">
    <div class="layui-card">
        <div class="layui-card-header" style="width: 98%"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;机器人实训教学 &nbsp;>&nbsp;
            班级管理
        </div>
    </div>
</div>
<div class="school-head" id="school-head" style="width: 98%">
    <div class="btn-groups" >
        <div class="layui-groups">
            <button type="button" class="layui-btn" id="add4">新增</button>
            <button type="button" class="layui-btn" id="add3">修改</button>
            <button type="button" class="layui-btn" id="dele">删除</button>
        </div>
    </div>
    <div class="demoTable" style="width: 45%;justify-content: flex-end;">
        <div class="layui-inline">
            <input class="layui-input" name="id" id="demoReload" autocomplete="off" placeholder="搜索班级名称">
        </div>
        <button class="layui-btn" data-type="reload" id="see">搜索</button>
    </div>
</div>

<div class="layui-card-body" style="width: 98%">
    <table class="layui-hide" id="table_user" lay-filter="user"></table>
</div>

<script src="../../static/res/layui/layui.js" charset="utf-8"></script>
<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
<script>
    layui.use(['table', 'layedit', 'laydate', 'jquery'], function () {
        var table = layui.table
            , layer = layui.layer
            , layedit = layui.layedit
            , $ = layui.jquery
            , laydate = layui.laydate;
        //方法级渲染
        table.render({
            elem: '#table_user'
            , url: '/teach_task/class'
            , toolbar: 'school-head'
            , max_height: 1000
            , type: "get"
            , cols: [[
                {type: 'radio'}
                , {field: 'a', align: "center", title: '序号', width: "5%", type: 'numbers'}
                , {field: 'b', align: "center", title: '班级名称', width: "10%"}
                , {field: 'a', align: "center", title: '班级编号', width: "10%"}
                , {field: 'c', align: "center", title: '所属专业', width: "10%"}
                , {field: 'd', align: "center", title: '授课教师', width: "10%"}
                , {field: 'e', align: "center", title: '状态', width: "10%"}
                , {field: 'f', align: "center", title: '开课时间', width: "10%"}
                , {field: 'g', align: "center", title: '关课时间', width: "10%"}
                , {field: 'h', align: "center", title: '创建人员', width: "10%"}
                , {field: 'i', align: "center", title: '操作时间', width: "15%"}
            ]]
            , page: true
        });
        //新增弹窗
        $("#add4").on('click', function () {
            //console.log("data");
            //页面层
            layer.open({
                title: '班级管理',
                type: 2,
                area: ['800px', '600px'],//宽高
                content: 'class_update'
            });

        });
        //修改弹窗
        $('#add3').on('click',function(){
             layer.open({
                title: '班级管理',
                type: 2,
                area: ['800px', '600px'],//宽高
                content: 'class_update'
            });
        })
        //删除功能
        $('#dele').on('click', function () {
            var checkStatus = table.checkStatus('table_user'),
                data = checkStatus.data;
            if (data.length == 0) {
                layer.msg('请选择删除的对象')
            } else {
                layer.confirm("确认要删除吗，删除后不能恢复", {title: "删除确认"}, function (index) {
                    $.ajax({
                        url: "/teach_task/class_delete_search",
                        type: "get",
                        data: {"major_code": data[0].b},
                        success: function (res) {
                            if (res.result == "fail") {
                                layer.msg(res.msg)
                            } else {
                                layer.msg(res.result)
                                setTimeout(function () {
                                    table.reload("table_user")
                                }, 1000)
                            }
                        }
                    })
                });
            }
        })
        //搜索功能
        $('#see').on('click', function () {
            console.log('aaa')
            var val = $('#demoReload').val()
            console.log(val)
            table.reload('table_user', {
                url: '/teach_task/class_delete_search'
                , method: 'post'
                , where: {
                    "class_name": val,
                } //设定异步数据接口的额外参数

            });
        })
    });
</script>

</body>
</html>