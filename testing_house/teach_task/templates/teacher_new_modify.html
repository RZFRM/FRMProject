<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>教师管理/新增/修改</title>
    <link rel="stylesheet" href="../../static/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../static/res/static/css/purchasing.css">
    <style>
        .forn {
            width: 350px;
            margin: 0 auto;
        }

        ul {
            position: absolute;
            top: 95px;
            left: 17px;
        }

        .atitle > span {
            margin-left: 5px;
            width: 61px;
            height: 15px;
            font-size: 14px;
            font-family: Microsoft YaHei;
            font-weight: 400;
            color: rgba(51, 51, 51, 1);
        }

        .atitle > button {
            width: 27px;
            height: 25px;
            border: none;
            background: rgba(248, 248, 248, 1);
            margin-left: 600px;
        }

        .remind {
            width: 356px;
            height: 39px;
            font-size: 14px;
            font-family: Microsoft YaHei;
            font-weight: 400;
            color: rgba(255, 84, 0, 1);
            margin: 30px 0 0 42px;
        }

        .remind > p:nth-child(2) {
            color: #0C0C0C;
            margin: 8px;
        }

        .remind > p:nth-child(3) {
            color: #0C0C0C;
            margin: 8px;
        }

        .btn {
            width: 105px;
            height: 39px;
            background: rgba(55, 38, 89, 1);
            border-radius: 4px;
            font-size: 14px;
            text-align: center;
            line-height: 39px;
            border: 0;
            color: #fff;
            cursor: pointer;
            position: absolute;
            left: 44%;
            bottom: 32px;
        }
    </style>
</head>
<body style="background-color: #FFFFFF">
<div class="Popout">

    <div>
        <p>新增/修改</p>
    </div>
    <div style="height: 425px;overflow: auto;padding-top:25px">
        <form class="layui-form forn" action="" lay-filter="component-form-group">
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">用户名：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" id="user_name" class="layui-input" placeholder="请输入用户名"
                           style="min-height: 30px;line-height: 20px; height: 20px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">密码：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" id="pwd" class="layui-input" placeholder="请输入密码"
                           style="min-height: 30px;line-height: 20px; height: 20px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">教师姓名：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" id="teacher_name" class="layui-input" placeholder="请输入教师姓名"
                           style="min-height: 30px;line-height: 20px; height: 20px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">手机号码：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" id="phone" class="layui-input" placeholder="请输入手机号码"
                           style="min-height: 30px;line-height: 20px; height: 20px;">
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;"><span
                        class="xing"></span>是否有效：</label>
                <div class="layui-input-block" style="min-height: 30px;">
                    <select name="modules" lay-verify="required" lay-search="" id="teacher_select"
                            style="width:100%;height: 30px;">
                        <option style="height: 32px" value="">请选择</option>
                        <option value="True">是</option>
                        .
                        <option value="False">否</option>
                    </select>
                </div>
            </div>
            <div class="remind">
                <p>提示：</p>
                <p>1.设置为无效后，该账号无法登陆。</p>
                <p>2.教师账号未添加学生可删除，否则不可删除。</p>
            </div>
            <button class="btn" type="button" lay-submit="" id="teacher_btn" lay-filter="teacher_btn">提交</button>

        </form>
    </div>
</div>
</div>
<script src="../../static/layuiadmin/layui/layui.js"></script>
<script>
    layui.use(['form', 'layedit', 'laydate', 'jquery'], function () {
        var form = layui.form
            , layer = layui.layer
            , layedit = layui.layedit
            , $ = layui.jquery
            , laydate = layui.laydate;
        //验证手机号码是否正确
        $("#phone").blur(function () {
            var phone = $('#phone').val()
            var myreg = /^[1][3,4,5,7,8][0-9]{9}$/;
            if (!myreg.test(phone)) {
                layer.msg("输入的手机号码不正确")
            }

        });
        //原来的用户名
        $(function(){
           return  old_user_name= $('#user_name').val()
            console.log(old_user_name)
        })
        //提交数据
        $("#teacher_btn").on('click', function () {
            var user_name = $('#user_name').val()
            var pwd = $('#pwd').val()
            var teacher_name = $('#teacher_name').val()
            var phone = $('#phone').val()
            var teacher_select = $('#teacher_select').val()
            console.log(user_name, pwd, teacher_name, phone, teacher_select)
            if (user_name == '' || pwd == '' || teacher_name == '' || teacher_select == '') {
                layer.msg('请填写完整')
            } else {

                var myreg = /^[1][3,4,5,7,8][0-9]{9}$/;
                if (!myreg.test(phone)) {
                    layer.msg('您输入的手机号有误')
                } else {
                    $.ajax({
                        url: '/teach_task/teacher_updata',
                        type: 'post',
                        data: {
                            'admin_name': teacher_name,
                            'user_name': user_name,
                            'user_pass': pwd,
                            'phone': phone,
                            'admin_state': teacher_select,
                            'old_user_name':old_user_name
                        },
                        success: function (res) {
                            console.log(res)
                            if (res.result == 'fail') {
                                layer.msg(res.msg)
                            } else {
                                layer.msg(res.result)
                                setTimeout(function () {
                                    window.parent.location.reload();
                                }, 1000)
                            }
                        }
                    })
                }
            }
        })

    });

</script>
</body>
</html>