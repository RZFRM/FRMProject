<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>第一步</title>
    <link rel="stylesheet" href="../../static/layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../static/res/static/css/purchasing.css">
    <style>
        .forn {
            width: 350px;
            margin: 0 auto;
        }

        ul {
            position: absolute;
            top: 95px;
            left: 17px;
        }

        .atitle > span {
            margin: 0 auto;
        }

        .btn {
            width: 105px;
            height: 39px;
            background: rgba(55, 38, 89, 1);
            border-radius: 4px;
            font-size: 14px;
            text-align: center;
            line-height: 39px;
            border: 0;
            color: #fff;
            cursor: pointer;
            position: absolute;
            left: 44%;
            bottom: 32px;
        }
    </style>
</head>
<body>
<div class="Popout">
    <div class="atitle">
        <span>销售申请</span>
    </div>
    <ul>
        <li class="ULI"><a lay-href="javascript:;" class="ULIP"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
        <li><a href="javascript:;"></a></li>
    </ul>

    <div style="height: 417px;overflow: auto;padding-top:25px">
        <form class="layui-form forn" action="">
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">合同编号：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" name="sales_number"
                           style="min-height: 30px;line-height: 30px; height: 30px;" id="sales_number">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">客户名称：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <select name="Client_Name" lay-verify="required" lay-filter="test" lay-search="" style="width:100%;height: 30px;">
                        <option value="">直接选择或搜索选择</option>
                        <option value="002">天地建筑工程有限公司</option>
                        <option value="003">翔辉建筑工程有限公司</option>
                        <option value="004">兴海建筑工程有限公司</option>
                        <option value="007">德星建筑工程有限公司</option>
                        <option value="008">正发建筑工程有限公司</option>
                    </select>

                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;"><span
                        class="xing">*</span>业务类型：</label>
                <div class="layui-input-block" style="min-height: 30px;">
                    <select name="Business_Type" lay-verify="required" lay-filter="test" lay-search=""
                            style="width:100%;height: 30px;">
                        <option value="">直接选择或搜索选择</option>
                        <option value="普通销售">普通销售</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;"><span
                        class="xing">*</span>销售类型：</label>
                <div class="layui-input-block" style="min-height: 30px;">
                    <select name="Sales_Type" lay-verify="required" lay-filter="test" lay-search=""
                            style="width:100%;height: 30px;">
                        <option value="">直接选择或搜索选择</option>
                        <option value="直接销售">直接销售</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <label class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;"><span
                        class="xing">*</span>产品名称：</label>
                <div class="layui-input-block" style="min-height: 30px;">
                    <select name="Product_Name" lay-verify="required" lay-filter="test" lay-search=""
                            style="width:100%;height: 30px;">
                        <option value="">直接选择或搜索选择</option>
                        <option value="甲类建材">甲类建材</option>
                        <option value="乙类建材">乙类建材</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;"><span class="xing">*</span>数量：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" name="Quantity" lay-verify="required|number|quantity" autocomplete="off"
                           class="layui-input" placeholder="请输入数量" onkeyup="checkInt(this)" id=txtAmount
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>

            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;"><span class="xing">*</span>单位：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" id="Unit" class="layui-input" placeholder="请输入单位  例:台,个"
                           style="min-height: 30px;line-height: 30px; height: 30px;"  name="Unit">
                </div>
            </div>

            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;"><span class="xing">*</span>不含税单价：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" placeholder="请输入不含税单价" name="Excluding_tax_univalent"
                           style="min-height: 30px;line-height: 30px; height: 30px;" name="Excluding_tax_univalent"
                           onkeyup="checkInt(this)" id=txtPrice
                           lay-verify="required|number|price">
                </div>
            </div>


            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">税率/征收率：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" placeholder="请输入税率"
                           style="min-height: 30px;line-height: 30px; height: 30px;" id=txtTotal onkeyup="checkInt(this)"
                           name="Tax_Rate_Or_Levy_Rate">
                </div>
            </div>

            <!--计算公式计算总金额-->
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px;">总金额：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" placeholder=""
                           style="min-height: 30px;line-height: 30px; height: 30px;" id=txtTotal onkeyup="checkInt(this)"
                           name="Total_Amount">
                </div>
            </div>

            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">交货日期：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="2020-12-16" readonly
                           style="min-height: 30px;line-height: 30px; height: 30px;" name="Delivery_dates">
                </div>
            </div>


            <div class="layui-form-item">
                <label class="layui-form-label" style="padding:5px 15px;"><span class="xing">*</span>申请人：</label>
                <div class="layui-input-block" style="min-height: 30px;">
                    <select name="Applicant" lay-verify="required" lay-search="" style="width:100%;height: 30px;">
                        <option value="">直接选择或搜索选择</option>
                        <option value="余静">余静</option>
                    </select>
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">申请部门：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="销售部" readonly
                           style="min-height: 30px;line-height: 30px; height: 30px;" name="Application_sector">
                </div>
            </div>

            <!--需要修改-->
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">申请日期：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="2020-12-20" readonly
                           style="min-height: 30px;line-height: 30px; height: 30px;" name="Application_Date">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">部门负责人：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="王英" name="Department_Head" readonly
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            <div class="layui-form-item">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">公司负责人：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="李宏" name="Company_Representative" readonly
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
            <div class="layui-form-item" style="display: none">
                <lable class="layui-form-label" style="padding:5px 15px 5px 10px;;width: 85px;">机器人名称：</lable>
                <div class="layui-input-block" style="min-height: 30px;">
                    <input type="text" autocomplete="off" class="layui-input" value="销售申请机器人" name="job_type" readonly
                           style="min-height: 30px;line-height: 30px; height: 30px;">
                </div>
            </div>
           <!-- {#            <a class="btn" href="purchaes_requisitions_determine" class="layui-btn">提交</a>#}-->
            <button class="layui-btn btn" lay-submit="" lay-filter="demo1">提交</button>
        </form>
        <div style="clear: both"></div>
    </div>
</div>
<script src="../../static/layuiadmin/layui/layui.js"></script>
<script>
    layui.use(['form', 'layedit', 'laydate', 'jquery'], function () {
        var form = layui.form
            , layer = layui.layer
            , layedit = layui.layedit
            , $ = layui.jquery
            , laydate = layui.laydate;


        //日期
        laydate.render({
            elem: '#date'
        });
        laydate.render({
            elem: '#date1'
        });

        //自定义验证规则
        form.verify({
            uname: function (value) {
                if (!new RegExp("^[a-zA-Z0-9_\u4e00-\u9fa5\\s·]+$").test(value)) {
                    return '用户名不能有特殊字符';
                }
            },
            price: function (value) {
                if (!new RegExp("^((\\d+(\.\\d?[1-9])?)|(\\d*[1-9]\\d*\\.\\d{0,2}))$").test(value)) {
                    return '价格大于0,且最多有两位小数'
                }
            },
            quantity: function (value) {
                if (value <= 0) {
                    return "数量必须大于0"
                }
            }
        });
        form.on('submit(demo1)', function (data) {
            //通用表单提交(AJAX方式)
            config.log('aaaaa')
            $.ajax({
                url: "/Sales_requisition_data_1",
                type: "post",
                datatype: "json",
                data: $(data.form).serialize(),
                success: function (res) {
                    if (res == 200) {

                        location.href = "/Sales_created_2"
                    }
                }
            });
            return false;  //阻止表单跳转。如果需要表单跳转，去掉这段即可。
        });

        form.on('select(test)', function (data) {
            if(data.value == "002"){
                $("#unit").val("盘")
            }else if(data.value == "003"){
                $("#unit").val("套")
            }else if(data.value == "004"){
                $("#unit").val("套")
            }else if(data.value == "007"){
                $("#unit").val("个")
            }else if(data.value == "008"){
                $("#unit").val("件")
            }else if(data.value == "009"){
                $("#unit").val("打")
            }else if(data.value == "010"){
                $("#unit").val("套")
            }else if(data.value == "011"){
                $("#unit").val("次")
            }
        });
    })
    ;

    function checkInt(o) {
        theV = isNaN(parseInt(o.value)) ? 0 : parseInt(o.value);
        if (theV != o.value) {
            o.value = theV;
        }
        txtTotal.value = txtAmount.value * txtPrice.value;
    }

    function checkP(o) {
        theV = isNaN(parseFloat(o.value)) ? 0 : parseFloat(o.value);
        theV = parseInt(theV * 100) / 100;
        if (theV != o.value) {
            theV = (theV * 100).toString();
            theV = theV.substring(0, theV.length - 2) + "." + theV.substring(theV.length - 2, theV.length)
            o.value = theV;
        }
        txtTotal.value = txtAmount.value * txtPrice.value;
    }
</script>
</body>
</html>